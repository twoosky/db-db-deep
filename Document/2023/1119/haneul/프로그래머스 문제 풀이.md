## 상품 별 오프라인 매출 구하기
```SQL
SELECT P.PRODUCT_CODE, SUM(P.PRICE * OS.SALES_AMOUNT) AS SALES
FROM PRODUCT AS P INNER JOIN OFFLINE_SALE AS OS
ON P.PRODUCT_ID = OS.PRODUCT_ID
GROUP BY P.PRODUCT_CODE
ORDER BY SALES DESC, P.PRODUCT_CODE;
```
> 문제 링크 https://school.programmers.co.kr/learn/courses/30/lessons/131533

## 상품을 구매한 회원 비율 구하기
```sql
WITH USERS AS (
    SELECT *
    FROM USER_INFO
    WHERE YEAR(JOINED) = 2021
)

SELECT YEAR(SALES_DATE) AS YEAR, MONTH(SALES_DATE) AS MONTH, 
COUNT(DISTINCT(O.USER_ID)) AS PUCHASED_USERS,
ROUND(COUNT(DISTINCT(O.USER_ID)) / (SELECT COUNT(*) FROM USERS), 1) AS PUCHASED_RATIO
FROM ONLINE_SALE AS O INNER JOIN USERS AS U
ON O.USER_ID = U.USER_ID
GROUP BY YEAR, MONTH
ORDER BY YEAR, MONTH
```

설명 하면 좋을 부분
* WITH 절 사용해 INNER JOIN시 조인 데이터 수 감소 -> 성능에 영향이 있을까?
* ROUND 소수점, 집계함수 정리
* DISTINCT 중복 제거 -> 같은 년,월 에 두 번 구매한 유저가 있을 수 있으므로



> 문제 링크 https://school.programmers.co.kr/learn/courses/30/lessons/131534
